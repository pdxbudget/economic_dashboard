```{r}
data <- list()
data$fred <- list()
data$port <- list()
```

```{r, data_fred}

# This product uses the FREDÂ® API but is not endorsed or certified by the Federal Reserve Bank of St. Louis.

fredr_set_key(fredr_get_key())
```

```{r, data_port}
if (
  # if xlsx file is NOT in the inputs folder OR...
  !file.exists("inputs//data_port.xlsx") |
  # if port data was last modified last month (or before that)...
  month(file.mtime("inputs/data_port.xlsx")) < month(today())) {
  # ... fetch new data
  
  download.file(
    "https://cdn.portofportland.com/pdfs/February%202022%20Statistics%20(Excel).xlsx", 
    destfile = "inputs/data_port.xlsx", mode = "wb")
}

data$port$passenger <- read_xlsx(
  "inputs/data_port.xlsx", sheet = "Passenger Traffic Report",
  skip = 5)
data$port$freight <- read_xlsx(
  "inputs/data_port.xlsx", sheet = "Freight Traffic Report",
  skip = 5)

data$port <- data$port %>%
  map(filter, Carrier %in% c("PDX Total", "PDX Total *")) %>%
  map(select, 5:7) # keep YTD columns only
```