```{r}
data <- list()
data$fred <- list()
data$port <- list()
```

```{r, data_port}
# if port data was last modified last month (or before that),
# download new file

if (month(file.mtime("inputs/data_port.xlsx")) < month(today())) {
  download.file(
  "https://cdn.portofportland.com/pdfs/February%202022%20Statistics%20(Excel).xlsx", 
  destfile = "inputs/data_port.xlsx", mode = "wb")
}

data$port$passenger <- read_xlsx(
  "inputs/data_port.xlsx", sheet = "Passenger Traffic Report",
  skip = 5)
data$port$freight <- read_xlsx(
  "inputs/data_port.xlsx", sheet = "Freight Traffic Report",
  skip = 5)

data$port <- data$port %>%
  map(filter, Carrier %in% c("PDX Total", "PDX Total *")) %>%
  map(select, 5:7) # keep YTD columns only
```